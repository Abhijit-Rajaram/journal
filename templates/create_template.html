{% extends 'base.html' %}
{% block content %}
<h2>Create Task Template</h2>

<form method="POST">

    <div class="mb-3">
        <label>Task Name</label>
        <input class="form-control" type="text" name="name" required>
    </div>

    <div class="mb-3">
        <label>Description</label>
        <input class="form-control" type="text" name="description">
    </div>

    <div class="mb-3">
        <label>Frequency</label>
        <select class="form-select" name="frequency" id="freqSelect">
            <option value="daily">Daily</option>
            <!-- <option value="once">One-time</option> -->
            <option value="weekly">Weekly</option>
            <option value="monthly">Monthly</option>
            <option value="date">Specific Date</option>
        </select>
    </div>

    <!-- WEEKLY -->
    <div id="weeklyDiv" style="display:none;">
        <label>Select Days</label><br>
        <label><input type="checkbox" name="weekdays" value="mon"> Mon</label>
        <label><input type="checkbox" name="weekdays" value="tue"> Tue</label>
        <label><input type="checkbox" name="weekdays" value="wed"> Wed</label>
        <label><input type="checkbox" name="weekdays" value="thu"> Thu</label>
        <label><input type="checkbox" name="weekdays" value="fri"> Fri</label>
        <label><input type="checkbox" name="weekdays" value="sat"> Sat</label>
        <label><input type="checkbox" name="weekdays" value="sun"> Sun</label>
    </div>

    <!-- MONTHLY -->
    <div id="monthlyDiv" style="display:none;">
        <label>Day of Month (1â€“31)</label>
        <input class="form-control" type="number" name="day_of_month" min="1" max="31">
    </div>

    <!-- SPECIFIC DATE -->
    <div id="dateDiv" style="display:none;">
        <label>Choose Date</label>
        <input class="form-control" type="date" name="specific_date">
    </div>

    <br>
    <button class="btn btn-primary">Create Template</button>

</form>


<script>
function updateFields() {
    let f = document.getElementById("freqSelect").value;

    // Hide all
    document.getElementById("weeklyDiv").style.display = "none";
    document.getElementById("monthlyDiv").style.display = "none";
    document.getElementById("dateDiv").style.display = "none";

    // Disable all
    document.querySelectorAll("#weeklyDiv input").forEach(el => el.disabled = true);
    document.querySelector("#monthlyDiv input").disabled = true;
    document.querySelector("#dateDiv input").disabled = true;

    // Enable visible fields
    if (f === "weekly") {
        document.getElementById("weeklyDiv").style.display = "block";
        document.querySelectorAll("#weeklyDiv input").forEach(el => el.disabled = false);
    }

    if (f === "monthly") {
        document.getElementById("monthlyDiv").style.display = "block";
        document.querySelector("#monthlyDiv input").disabled = false;
    }

    if (f === "date") {
        document.getElementById("dateDiv").style.display = "block";
        document.querySelector("#dateDiv input").disabled = false;
    }
}

document.getElementById("freqSelect").addEventListener("change", updateFields);

// Run on page load (prevents validation error)
updateFields();
</script>


{% endblock %}
